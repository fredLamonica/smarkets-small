<div class="modal-header">
  <div class="modal-title" id="modal-basic-title">
    {{ idPermissao ? 'Alterar' : 'Incluir' }} permissão
  </div>
  <button type="button" class="close" aria-label="Close" (click)="cancelar()">
    <i class="fas fa-times"></i>
  </button>
</div>
<div class="modal-body">
  <div class="form-row" [formGroup]="formBusca" *ngIf="!idPermissao">
    <div class="form-group col">
      <input
        type="text"
        class="form-control"
        id="termo"
        formControlName="termo"
        placeholder="Nome da empresa ou Documento"
        (keyup.enter)="buscar()"
      />
    </div>
    <div class="form-group col">
      <button class="btn btn-primary" (click)="buscar()">
        <i class="fas fa-search"></i> Buscar
      </button>
    </div>
  </div>
  <div class="card" *ngIf="!idPermissao">
    <div class="card-body">
      <div class="row">
        <div class="col">
          <custom-table
            classes="table-striped table-sm"
            [settings]="settings"
            [source]="empresas"
            (select)="selecao($event)"
          ></custom-table>
          <pager
            size="sm"
            [page]="pagina"
            [total-pages]="totalPaginas"
            [records-per-page]="itensPorPagina"
            (pagination)="paginacao($event)"
          ></pager>
        </div>
      </div>
    </div>
  </div>

  <form [formGroup]="form">
    <div class="form-row">
      <div class="form-group col-12" *ngIf="idPermissao">
        <label for="razaoSocial"> Razão Social </label>
        <input
          type="text"
          class="form-control"
          name="razaoSocial"
          formControlName="razaoSocial"
          readonly
        />
      </div>
      <div class="form-group col-lg-6" *ngIf="idPermissao">
        <label for="nomeFantasia"> Nome fantasia </label>
        <input
          type="text"
          class="form-control"
          name="nomeFantasia"
          formControlName="nomeFantasia"
          readonly
        />
      </div>
      <div class="form-group col-lg-6" *ngIf="idPermissao">
        <label for="razaoSocial"> CPF/CNPJ </label>
        <input type="text" class="form-control" name="cnpj" formControlName="cnpj" readonly />
      </div>
    </div>
    <div class="form-row">
      <div class="form-group required col-lg-6">
        <label for="perfil"> Perfil </label>
        <ng-select
          id="perfil"
          [items]="perfis"
          name="perfil"
          formControlName="perfil"
          (change)="changePerfil()"
          [class.invalid]="form.controls.perfil.invalid && form.controls.perfil.dirty"
        >
          <ng-template ng-label-tmp let-item="item">
            {{ getProfileEnum(item) }}
          </ng-template>
          <ng-template ng-option-tmp let-item="item">
            {{ getProfileEnum(item) }}
          </ng-template>
        </ng-select>
        <span class="invalid" *ngIf="form.controls.perfil.invalid && form.controls.perfil.dirty">
          Preenchimento obrigatório
        </span>
      </div>
    </div>
    <div class="form-row">
      <div
        class="form-group col-lg-6"
        [ngClass]="{ required: this.camposObrigatorio ? true : false }"
      >
        <label for="idCentroCusto"> Centro de custo </label>
        <ng-select
          id="idCentroCusto"
          [hideSelected]="true"
          name="idCentroCusto"
          formControlName="idCentroCusto"
        >
          <ng-option [value]="centroCusto.idCentroCusto" *ngFor="let centroCusto of centrosCusto">
            {{ centroCusto.descricao }}</ng-option
          >
        </ng-select>
      </div>
      <div
        class="form-group col-lg-6"
        [ngClass]="{ required: this.camposObrigatorio ? true : false }"
      >
        <label for="idDepartamento"> Departamento </label>
        <ng-select
          id="idDepartamento"
          [hideSelected]="true"
          name="idDepartamento"
          formControlName="idDepartamento"
        >
          <ng-option
            [value]="departamento.idDepartamento"
            *ngFor="let departamento of departamentos"
          >
            {{ departamento.descricao }}</ng-option
          >
        </ng-select>
      </div>
    </div>
  </form>
</div>
<div class="modal-footer">
  <button type="button" class="btn btn-outline-secondary" (click)="cancelar()">Cancelar</button>
  <button type="button" class="btn btn-outline-primary" (click)="salvar()">Salvar</button>
</div>
