<div class="row">
  <div class="filtro col-sm-6 col-lg-4 col-xl-3 col-xxxl-2">
    <smk-filtro-catalogo
      [filtro]="filtro"
      [ativo]="ativa"
      [empresa]="empresa"
      (filtroChange)="filtroChange($event)">
    </smk-filtro-catalogo>
  </div>
  <div *ngIf="produtosLoading" class="spinner spinner-secondary mx-auto"></div>
  <div class="col-sm-6 col-lg-8 col-xl-9 col-xxxl-10" [class.d-none]="produtosLoading">
    <div class="d-flex align-items-start align-items-lg-center flex-column flex-lg-row">
      <div class="breadcrumb p-0 flex-grow-1">
        <span class="d-none d-xl-block pr-2">
          Marketplace
          <i class="separador fas fa-chevron-right mx-1"></i>
          Produtos em Catálogo
          <i class="separador fas fa-chevron-right mx-1"></i>
        </span>
        <form [formGroup]="form">
          <div class="form-row">
            <div class="col">
              <ng-select #empresaSelect
                placeholder="Selecione uma empresa"
                [items]="empresas"
                [loading]="empresasLoading"
                [searchable]="true"
                [clearable]="true"
                clearAllText="Limpar"
                loadingText="Carregando"
                formControlName="empresaCatalogo"
                class="empresaSelect">
                <ng-template ng-label-tmp let-item="item">
                  {{ item.nomeFantasia ? item.nomeFantasia : item.razaoSocial }}
                </ng-template>
                <ng-template ng-option-tmp let-item="item">
                  <span [title]="item.razaoSocial">
                    {{ item.nomeFantasia ? item.nomeFantasia : item.razaoSocial }}<br />
                  </span>
                </ng-template>
              </ng-select>
            </div>
            <div class="col">
              <ng-select #catalogoSelect
                placeholder="Selecione um catálogo"
                [items]="opcoesTipoCatalogo"
                [searchable]="true"
                [clearable]="true"
                clearAllText="Limpar"
                formControlName="tipoCatalogo"
                bindValue="index"
                class="empresaSelect">
                <ng-template ng-label-tmp let-item="item">
                  {{ item.name }}
                </ng-template>
                <ng-template ng-option-tmp let-item="item">
                  <span [title]="item.name">
                    {{ item.name }}<br />
                  </span>
                </ng-template>
              </ng-select>
            </div>
          </div>
        </form>
      </div>
      <div class="d-flex align-items-center">
        <span class="ordenation-filter">Classificar por:</span>
        <div class="dropdown">
          <button
            class="btn btn-link dropdown-toggle d-flex font-weight-bold"
            type="button"
            id="ordenacao"
            data-toggle="dropdown"
            aria-haspopup="true"
            aria-expanded="false">
            {{ filtro.ordenacao.descricao }}
          </button>
          <div class="opcoes-de-ordenacao dropdown-menu" aria-labelledby="ordenacao">
            <a
              class="dropdown-item"
              (click)="ordenar(ordenacao)"
              *ngFor="let ordenacao of opcoesOrdenacao">
              {{ ordenacao.descricao }}
            </a>
          </div>
        </div>
      </div>
    </div>
    <div class="row" *ngIf="!registros?.length && !isFirstLoad; else itensTmp">
      <div class="col-12 no-content" translate>GENERAL.NO_RECORDS_FOUND</div>
      <div class="col-12">
        <p class="text-center">Gostaria de solicitar o cadastro do produto?</p>
      </div>
      <div class="col-12 d-flex justify-content-center">
        <button class="btn btn-primary" (click)="solicitarCadastro()">
          <i class="fas fa-edit"></i> Solicitar o cadastro do Produto
        </button>
      </div>
    </div>
  </div>
</div>

<ng-template #itensTmp>
  <div class="row produtos">
    <ng-container *ngFor="let item of registros; let i = index">
      <div class="col-12 col-lg-6 col-xl-4 col-xxl-4 col-xxxl-3 col-xxxxxl-2 mb-3">
        <catalogo-item
          (add-carrinho)="adicionarAoCarrinho($event)"
          [item]="item"
          [podeAdicionarCarrinho]="podeAdicionarCarrinho"
          (triggerFocusEmpresaCompradora)="executeTriggerFocusEmpresaCompradora()">
        </catalogo-item>
      </div>
    </ng-container>
  </div>
  <div class="row">
    <pager
      class="col"
      [page]="pagina"
      [total-pages]="totalPaginas"
      [records-per-page]="registrosPorPagina"
      [records-per-page-options]="[15, 30, 60]"
      (pagination)="paginar($event)">
    </pager>
  </div>
</ng-template>