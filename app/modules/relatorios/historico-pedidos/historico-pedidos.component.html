<!-- #region -->
<div class="header">
  <div class="header-search row align-items-center">
    <div class="col-lg-12">
      <h4 class="title">RELATÓRIO DE PEDIDOS</h4>
    </div>
  </div>
</div>
<div class="container">
  <div class="row justify-content-center">
    <div class="col-lg-12">
      <div class="form-row justify-content-center" [formGroup]="formFiltro">
        <div class="form-group required col-12 col-lg-4">
          <label>Empresas: </label>
          <ng-select
            class="full-width"
            clearAllText="Limpar"
            [multiple]="true"
            searchable="false"
            [items]="empresas"
            bindValue="idTenant"
            [loading]="empresasLoading"
            [loadingText]="'buscando...'"
            [closeOnSelect]="false"
            [searchFn]="empresaSearchFn"
            formControlName="empresas"
            required>
            <ng-template ng-multi-label-tmp let-items="items" let-clear="clear" style="max-width: 80%">
              <div class="ng-value" style="max-width: 50%;" *ngFor="let item of items | slice: 0:1">
                <span class="ng-value-label text-truncate align-middle" style="max-width: 90%;">
                  {{ item.cnpj }} - {{ item.razaoSocial }}
                </span>
                <span
                  class="ng-value-icon right"
                  style="max-width: 10%;"
                  (click)="clear(item)"
                  aria-hidden="true">×</span>
              </div>
              <div class="ng-value" *ngIf="items.length > 1">
                <span class="ng-value-label">{{ items.length - 1 }} mais...</span>
              </div>
            </ng-template>
            <ng-template ng-option-tmp let-item="item" let-item$="item$" let-index="index">
              <div class="custom-control custom-checkbox mr-sm-2">
                <input
                  type="checkbox"
                  class="custom-control-input"
                  id="item-{{ index }}"
                  [ngModel]="item$.selected"
                  [ngModelOptions]="{standalone: true}" />
                <label class="custom-control-label pointer-events-none" for="item-{{ index }}">
                  {{ item.cnpj }} - {{ item.razaoSocial }}
                </label>
              </div>
            </ng-template>
          </ng-select>
        </div>
        <div class="form-group col-12 col-lg-4">
          <label for="competenciaData"> Competência: </label>
          <ng-select
            [items]="opcoesTipoDataFiltro"
            name="competenciaData"
            formControlName="tipoDataRelatorio"
            [searchFn]="customSearchCompetencia">
            <ng-template ng-label-tmp let-item="item">
              {{ tiposDataRelatorioPedido[item] }}
            </ng-template>
            <ng-template ng-option-tmp let-item="item">
              {{ tiposDataRelatorioPedido[item] }}
            </ng-template>
          </ng-select>
        </div>
        <div class="form-group col-12 col-lg-2">
          <label for="dataInicio"> Data Inicio: </label>
          <input class="form-control" type="date" name="dataInicio" formControlName="dataInicio" />
        </div>
        <div class="form-group col-12 col-lg-2">
          <label for="dataFim"> Data Fim: </label>
          <input class="form-control" type="date" name="dataFim" formControlName="dataFim" />
        </div>
      </div>
      <div class="form-row justify-content-end">
        <div class="form-group col-12 col-lg-2">
          <button class="btn btn-block btn-primary mt-1" (click)="downloadRelatorioPedidos()">
            <i class="fas fa-download"></i> Exportar
          </button>
        </div>
      </div>
    </div>
  </div>
</div>
<!-- #endregion -->
